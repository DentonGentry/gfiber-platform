#!/bin/sh

mkdir /tmp/cwmp
# dhclient populates the ACS_URL in /tmp/cwmp/acs_url
CWMP="/usr/bin/python /usr/catawampus/runserver.py --acs-url-file=/tmp/cwmp/acs_url --platform=gfmedia --ping_ip6dev=br0"
DELAY=60

until ${CWMP}; do
  echo "Catawampus exited with code $?.  Respawning in ${DELAY} seconds." >&2
  sleep ${DELAY}
done
